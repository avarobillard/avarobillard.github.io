{
  "hash": "4bac3702e193265e57ff67f34f169c73",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"EDS 220: Eaton and Palisades Fires\"\ndescription: \"An analysis covering false color imagery and social dimensions\"\ndate: 2025-12-01\ncategories: [MEDS, Python]\nimage: fire.png\ncitation:\n  url: https://avarobillard.github.io/posts/2025-12-01-eds220\nbibliography: references.bib\ndraft: false\n#draft-mode: linked\n---\n\nThe Palisades and Eaton Fires occurred in early January 2025 in very populated areas of Los Angeles County, California. Both fires began on January 7th and burned a combined total of about 37,469 acres [@starr2025spread].\n\n::: {.figure}\n![Fire Image](fireimage.png)\nView of Topanga, CA during the Palisades fire; Kyle Grillot for the New York Times\n:::\n\nIn this blog, we will walk through how to create a [false color image](https://earthobservatory.nasa.gov/features/FalseColor) using Landsat remote sensing and fire perimeter data to highlight the locations of the Palisades and Eaton Fires. We will also look at socioeconomic risk factors that could influence a community's response to a wildfire in the form of a [chloropleth map](https://en.wikipedia.org/wiki/Choropleth_map).\n\nCheck out the full analysis in detail on the associated [GitHub repository](https://github.com/avarobillard/eaton-palisades-fires-analysis)!\n\n### Analysis highlights:\n\n-   Geospatial data exploration and wrangling with `geopandas`\n-   NetCDF data exploration and wrangling with `xarray` and `rioxarray`\n-   Creation of true color and false color images using Landsat bands\n-   Mapping of vector and raster data and customization with `matplotlib`\n\n### About the data:\n\nWe will be using three datasets:\n\n**1) Fire perimeter data**\n\nThe data used to map the fire perimeters were retrieved as two shapefiles from the [City of Los Angeles GeoHub.](https://geohub.lacity.org/maps/ad51845ea5fb4eb483bc2a7c38b2370c/about) The layers contained dissolved fire perimeters in the form of polygons for the Eaton and Palisades fires. Each layer contained columns with an OBJECTID, type (Heat Perimeter), shape area and shape length, and a geometry column [@la2025_palisades_eaton_perimeters].\n\n**2) Landsat 8 satellite data**\n\nLandsat Collection 2 Level-2 atmospherically corrected surface reflectance data collected by the Landsat 8 satellite was used for this analysis, retrieved as a simplified collection of bands from the [Microsoft Planetary Computer data catalogue.](https://planetarycomputer.microsoft.com/dataset/landsat-c2-l2) This data was then clipped to the area of interest surrounding the fire perimeters and used in the form of a NetCDF with the [red, green, blue, near-infrared and shortwave infrared bands](https://www.usgs.gov/faqs/what-are-band-designations-landsat-satellites) as variables [@mpc_landsat_c2_l2].\n\n**3) Environmental Justice Index (EJI) data**\n\n2024 EJI data for California will be used for this analysis, retrieved in a geodatabase format from the [Agency for Toxic Substances and Disease Registry](https://www.atsdr.cdc.gov/place-health/php/eji/eji-data-download.html). This data contains a variety of socioeconomic variables that could influence a community's response to a wildfire, such as percentage without internet, aged 65+, or with asthma [@cdc_eji_year]. \n\n#### Load packages\n\n::: {#70dbe4b1 .cell execution_count=1}\n``` {.python .cell-code code-fold=\"true\"}\nimport os\nimport pandas as pd\nimport numpy as np\nimport geopandas as gpd\nimport xarray as xr\nimport rioxarray \nimport contextily as ctx\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Patch\n```\n:::\n\n\n### 1. Fire perimeter data exploration\n\nFirst, we want to import the data and do some initial exploration.\n\n::: {#83c6e597 .cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\"}\n# Import Palisades fire perimeter shapefile\nfp = os.path.join('data', 'Palisades_Perimeter_20250121', 'Palisades_Perimeter_20250121.shp')\npalisades_fire = gpd.read_file(fp)\n\n# Import Eaton fire perimeter shapefile\nfp = os.path.join('data', 'Eaton_Perimeter_20250121', 'Eaton_Perimeter_20250121.shp')\neaton_fire = gpd.read_file(fp)\n```\n:::\n\n\nPalisades Fire:\n\n::: {#f702faa4 .cell execution_count=3}\n``` {.python .cell-code code-fold=\"true\"}\n# Display first row of Palisades fire data\npalisades_fire.head(1)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>OBJECTID</th>\n      <th>type</th>\n      <th>Shape__Are</th>\n      <th>Shape__Len</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>Heat Perimeter</td>\n      <td>1182.082031</td>\n      <td>267.101144</td>\n      <td>POLYGON ((-13193543.302 4032913.077, -13193543...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nEaton Fire:\n\n::: {#1c39685d .cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\"}\n# Display first row of Eaton fire data\neaton_fire.head(1)\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>OBJECTID</th>\n      <th>type</th>\n      <th>Shape__Are</th>\n      <th>Shape__Len</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>Heat Perimeter</td>\n      <td>2206.265625</td>\n      <td>270.199719</td>\n      <td>POLYGON ((-13146936.686 4051222.067, -13146932...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nBoth data sets contain an OBJECTID, TYPE, SHAPE__ARE, SHAPE__LEN, and GEOMETRY column. The geometry type is polygon, so we can visualize what these look like using `matplotlib`.\n\n::: {#c4809501 .cell execution_count=5}\n``` {.python .cell-code code-fold=\"true\"}\n# Visualize polygons\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(9,5))\n\npalisades_fire.plot(ax=ax1, color = \"darkred\")\neaton_fire.plot(ax=ax2, color = \"darkred\")\n\n# Set individual subplot titles\nax1.set_title('Palisades Fire')\nax2.set_title('Eaton Fire')\n\nax1.axis('off')\nax2.axis('off')\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=689 height=235}\n:::\n:::\n\n\n::: {#67648876 .cell execution_count=6}\n``` {.python .cell-code code-fold=\"true\"}\n# Examine CRS details\nprint('Ellipsoid:', palisades_fire.crs.ellipsoid)\nprint('Datum:', palisades_fire.crs.datum)\nprint('Is geographic?:', palisades_fire.crs.is_geographic)\nprint('Is projected?:', palisades_fire.crs.is_projected)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEllipsoid: WGS 84\nDatum: World Geodetic System 1984 ensemble\nIs geographic?: False\nIs projected?: True\n```\n:::\n:::\n\n\n::: {#024b93ba .cell execution_count=7}\n``` {.python .cell-code code-fold=\"true\"}\n# Check that the CRS is the same for both fire perimeter data sets\nprint('CRS match?:', palisades_fire.crs == eaton_fire.crs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCRS match?: True\n```\n:::\n:::\n\n\nBased on our preliminary exploration, the fire perimeter data is made up of polygons when looking at the geometry column. Both the Palisades and Eaton fire perimeter data have the same projected CRS, WGS 84.\n\n### 2. NetCDF data import and exploration\n\nNext, we want to explore our `xarray` Landsat data, which comes in a NetCDF format. A NetCDF (network Common Data Form) is a data format that is designed to be self-describing and machine-independent, making it ideal for working with multi-dimensional datasets that have a lot of metadata required to understand the content. The [NetCDF data model](https://docs.unidata.ucar.edu/netcdf-c/current/netcdf_data_model.html#classic_model) consists of variables (the measured quantities), dimensions (the axes/independent quantities at which we measure the variables), and attributes (metadata). \n\nOpening our NetCDF file with `xarray` gives us an `xarray.DataSet`, which contains all of the key components of a NetCDF as well as coordinates (the dimension's values/units) [@hoyer2017xarray].\n\n::: {#878e5af8 .cell execution_count=8}\n``` {.python .cell-code code-fold=\"true\"}\n# Import Landsat data as xarray.Dataset\nfp = os.path.join('data', 'landsat8-2025-02-23-palisades-eaton.nc')\n\nlandsat = xr.open_dataset(fp)\n\nlandsat\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nhtml[data-theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 78MB\nDimensions:      (y: 1418, x: 2742)\nCoordinates:\n  * y            (y) float64 11kB 3.799e+06 3.799e+06 ... 3.757e+06 3.757e+06\n  * x            (x) float64 22kB 3.344e+05 3.344e+05 ... 4.166e+05 4.166e+05\n    time         datetime64[ns] 8B ...\nData variables:\n    red          (y, x) float32 16MB ...\n    green        (y, x) float32 16MB ...\n    blue         (y, x) float32 16MB ...\n    nir08        (y, x) float32 16MB ...\n    swir22       (y, x) float32 16MB ...\n    spatial_ref  int64 8B ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-566afe01-8ece-495c-a363-1f8151c2f218' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-566afe01-8ece-495c-a363-1f8151c2f218' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 1418</li><li><span class='xr-has-index'>x</span>: 2742</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4920e2a6-5a4b-4860-98a0-128f7d16603f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4920e2a6-5a4b-4860-98a0-128f7d16603f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.799e+06 3.799e+06 ... 3.757e+06</div><input id='attrs-2d240b30-2c34-4d9f-b1af-0862ac08d08f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d240b30-2c34-4d9f-b1af-0862ac08d08f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-059038ae-4a81-43ba-8c7e-c7f21c8da961' class='xr-var-data-in' type='checkbox'><label for='data-059038ae-4a81-43ba-8c7e-c7f21c8da961' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>-30.0</dd><dt><span>crs :</span></dt><dd>EPSG:32611</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>y coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd></dl></div><div class='xr-var-data'><pre>array([3799050., 3799020., 3798990., ..., 3756600., 3756570., 3756540.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.344e+05 3.344e+05 ... 4.166e+05</div><input id='attrs-609ba09a-bb64-43a4-b92e-2aab4e33c507' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-609ba09a-bb64-43a4-b92e-2aab4e33c507' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-90deb854-20a5-424f-b04f-b2ae32bfabb9' class='xr-var-data-in' type='checkbox'><label for='data-90deb854-20a5-424f-b04f-b2ae32bfabb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>metre</dd><dt><span>resolution :</span></dt><dd>30.0</dd><dt><span>crs :</span></dt><dd>EPSG:32611</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>x coordinate of projection</dd><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd></dl></div><div class='xr-var-data'><pre>array([334410., 334440., 334470., ..., 416580., 416610., 416640.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f37d1361-da3c-4e38-8648-1f1b6677ce75' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f37d1361-da3c-4e38-8648-1f1b6677ce75' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-153e97a0-1a51-4ef1-89b6-1c13c0335bfa' class='xr-var-data-in' type='checkbox'><label for='data-153e97a0-1a51-4ef1-89b6-1c13c0335bfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=datetime64[ns]]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-21989634-4490-4429-8e5f-6ef00988bf42' class='xr-section-summary-in' type='checkbox'  checked><label for='section-21989634-4490-4429-8e5f-6ef00988bf42' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>red</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fb534a7c-92a0-4c68-95d6-8ce407956fde' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb534a7c-92a0-4c68-95d6-8ce407956fde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26639d48-9436-4449-a5fb-bd8a5ce1c459' class='xr-var-data-in' type='checkbox'><label for='data-26639d48-9436-4449-a5fb-bd8a5ce1c459' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd></dl></div><div class='xr-var-data'><pre>[3888156 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>green</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1b01b36d-8950-4462-b42b-8735340de31e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1b01b36d-8950-4462-b42b-8735340de31e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a319e27f-03c6-46f7-b927-50d07db0d99a' class='xr-var-data-in' type='checkbox'><label for='data-a319e27f-03c6-46f7-b927-50d07db0d99a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd></dl></div><div class='xr-var-data'><pre>[3888156 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>blue</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-828106c5-15b0-4563-a8c4-96cf1bc82a06' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-828106c5-15b0-4563-a8c4-96cf1bc82a06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4a83325-50ff-4a53-bc98-bd09d058347f' class='xr-var-data-in' type='checkbox'><label for='data-b4a83325-50ff-4a53-bc98-bd09d058347f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd></dl></div><div class='xr-var-data'><pre>[3888156 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nir08</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ec36f4ea-e308-4ca8-b973-a3e876d1edeb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec36f4ea-e308-4ca8-b973-a3e876d1edeb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95ac1477-8460-4a5e-b18d-684df9b95ad0' class='xr-var-data-in' type='checkbox'><label for='data-95ac1477-8460-4a5e-b18d-684df9b95ad0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd></dl></div><div class='xr-var-data'><pre>[3888156 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>swir22</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-997829c4-8c15-4251-95a3-5b403846a996' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-997829c4-8c15-4251-95a3-5b403846a996' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bdba17d-a0d6-4303-bd2e-bff4fbaced4f' class='xr-var-data-in' type='checkbox'><label for='data-9bdba17d-a0d6-4303-bd2e-bff4fbaced4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>grid_mapping :</span></dt><dd>spatial_ref</dd></dl></div><div class='xr-var-data'><pre>[3888156 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b09bd113-9840-45c6-a161-e738948a6433' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b09bd113-9840-45c6-a161-e738948a6433' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d16f5740-7270-4630-993e-eadce77afc21' class='xr-var-data-in' type='checkbox'><label for='data-d16f5740-7270-4630-993e-eadce77afc21' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 11N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-117],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32611&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 11N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>-117.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;WGS 84 / UTM zone 11N&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Transverse_Mercator&quot;],PARAMETER[&quot;latitude_of_origin&quot;,0],PARAMETER[&quot;central_meridian&quot;,-117],PARAMETER[&quot;scale_factor&quot;,0.9996],PARAMETER[&quot;false_easting&quot;,500000],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;32611&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>334395.0 30.0 0.0 3799065.0 0.0 -30.0</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e360674a-d653-42c5-9d8d-80297be1c9e0' class='xr-section-summary-in' type='checkbox'  ><label for='section-e360674a-d653-42c5-9d8d-80297be1c9e0' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-85645a9d-df02-4c66-ab79-ec5bc4f97707' class='xr-index-data-in' type='checkbox'/><label for='index-85645a9d-df02-4c66-ab79-ec5bc4f97707' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([3799050.0, 3799020.0, 3798990.0, 3798960.0, 3798930.0, 3798900.0,\n       3798870.0, 3798840.0, 3798810.0, 3798780.0,\n       ...\n       3756810.0, 3756780.0, 3756750.0, 3756720.0, 3756690.0, 3756660.0,\n       3756630.0, 3756600.0, 3756570.0, 3756540.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=1418))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3275327d-117e-4e0a-a4a3-1a4876e93253' class='xr-index-data-in' type='checkbox'/><label for='index-3275327d-117e-4e0a-a4a3-1a4876e93253' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([334410.0, 334440.0, 334470.0, 334500.0, 334530.0, 334560.0, 334590.0,\n       334620.0, 334650.0, 334680.0,\n       ...\n       416370.0, 416400.0, 416430.0, 416460.0, 416490.0, 416520.0, 416550.0,\n       416580.0, 416610.0, 416640.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=2742))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-54a6321d-c0c7-4894-9030-8cd8835f0cf6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-54a6321d-c0c7-4894-9030-8cd8835f0cf6' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>\n```\n:::\n:::\n\n\nWhen exploring the Landsat `xarray.Dataset`, we can see that the **coordinates** include x, y, time, and spatial_ref. The **data variables** are red, green, blue, nir08, and swir22. When checking the **dimensions** of the dataset at the top, we see that there are 1418 pixels in the y direction and 2742 pixels in the x direction, which makes up each data variable/band (red, green, blue, etc.). Click on the page icon to the right of the red variable- we see that the **attributes** included a spatial_ref. The other data variables contain the same attribute. There are many coordinate attributes for spatial_ref, including crs_wkt which tells us that the CRS should be EPSG 32611. \n\n### 3. Restoring geospatial information\n\nAfter exploring our data, we need to restore the geospatial information to the Landsat `xarray.Dataset` and ensure that the coordinate reference systems for the fire perimeter data and Landsat data match before performing further analyses.\n\n::: {#e286a4a4 .cell execution_count=9}\n``` {.python .cell-code code-fold=\"true\"}\n# Check CRS of Landsat data\nprint('Landsat CRS:', landsat.rio.crs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLandsat CRS: None\n```\n:::\n:::\n\n\n`landsat` is not yet a geospatial object, but contains a CRS to apply in the spatial_ref variable.\n\n::: {#150509d9 .cell execution_count=10}\n``` {.python .cell-code code-fold=\"true\"}\n# Print the CRS contained in the crs_wkt attribute of the spatial_ref variable\nprint(landsat.spatial_ref.crs_wkt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPROJCS[\"WGS 84 / UTM zone 11N\",GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AUTHORITY[\"EPSG\",\"4326\"]],PROJECTION[\"Transverse_Mercator\"],PARAMETER[\"latitude_of_origin\",0],PARAMETER[\"central_meridian\",-117],PARAMETER[\"scale_factor\",0.9996],PARAMETER[\"false_easting\",500000],PARAMETER[\"false_northing\",0],UNIT[\"metre\",1,AUTHORITY[\"EPSG\",\"9001\"]],AXIS[\"Easting\",EAST],AXIS[\"Northing\",NORTH],AUTHORITY[\"EPSG\",\"32611\"]]\n```\n:::\n:::\n\n\nWe can use this information to recover the geospatial information.\n\n::: {#e47d977a .cell execution_count=11}\n``` {.python .cell-code code-fold=\"true\"}\n# Recover geospatial information by setting CRS on Landsat xarray.Dataset\nlandsat.rio.write_crs(32611, inplace=True)\nprint('Landsat CRS:', landsat.rio.crs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLandsat CRS: EPSG:32611\n```\n:::\n:::\n\n\nLastly, we need to ensure that all three data sets match in CRS. \n\n::: {#c3bf3472 .cell execution_count=12}\n``` {.python .cell-code code-fold=\"true\"}\n# Reproject fire perimeter data to Landsat CRS\npalisades_fire = palisades_fire.to_crs(landsat.rio.crs)\neaton_fire = eaton_fire.to_crs(landsat.rio.crs)\n\n# Confirm changes\nprint('Palisades and Landsat CRS match?:', palisades_fire.crs == landsat.rio.crs)\nprint('Eaton and Landsat CRS match?:', eaton_fire.crs == landsat.rio.crs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPalisades and Landsat CRS match?: True\nEaton and Landsat CRS match?: True\n```\n:::\n:::\n\n\n### 4. True color image\n\nThe next step is to create a true color (RBG) image using our Landsat variables. In a true color image, the red, green, and blue RS bands are displayed in the red, green, blue channels, respectively. \n\nWe first want to identify if there are NaN values to deal with before plotting the true color image and which bands these lie within.\n\n::: {#c1f966f0 .cell execution_count=13}\n``` {.python .cell-code code-fold=\"true\"}\n# Identify which bands have NaN values using a list of the bands\nfor band in ['red', 'green', 'blue', 'nir08', 'swir22']:\n    count = np.isnan(landsat[band].values).sum()\n    print(f\"There are {count} NaN values in the {band} band.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThere are 0 NaN values in the red band.\nThere are 1 NaN values in the green band.\nThere are 109 NaN values in the blue band.\nThere are 0 NaN values in the nir08 band.\nThere are 0 NaN values in the swir22 band.\n```\n:::\n:::\n\n\n::: {#accab6d7 .cell execution_count=14}\n``` {.python .cell-code code-fold=\"true\"}\n# RGB image with substituted NaN values and adjusted scales\nlandsat[['red', 'green', 'blue']].to_array().fillna(0).plot.imshow(robust = True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-15-output-1.png){width=621 height=464}\n:::\n:::\n\n\nUsing **robust = True** uses 2nd and 98th percentiles of data instead of absolute min and max avoids extreme outliers like clouds to make the image visible, correcting any scale and clipping range issues that might be encountered otherwise. **Filling the NaN values** (found mostly in the blue band) with 0 allows the values to be correctly cast and plotted. The final true color image shows a visible range of the band values.\n\n### 5. False color image\n\nNext, we want to plot a preliminary false color image using the short-wave infrared (swir22), near-infrared, and red variables mapped to the red, green, and blue channels respectively. This allows us to see non-visible wavelenghts and better show aspects of our environment like burn severity.\n\n::: {#6daeba4e .cell execution_count=15}\n``` {.python .cell-code code-fold=\"true\"}\n# Create false color image\nlandsat[['swir22', 'nir08', 'red']].to_array().fillna(0).plot.imshow(robust = True)\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-16-output-1.png){width=621 height=464}\n:::\n:::\n\n\n### 6. Map\n\nLastly, we want to combine all of our data into a visualization of false color fire scars and the original fire perimeters using `matplotlib`. Check out the code below to see how this was plotted in detail!\n\n::: {#66c25e0b .cell execution_count=16}\n``` {.python .cell-code code-fold=\"true\"}\n# Create map\nfig, ax = plt.subplots(figsize = (10,8))\n\n# Add false color image\nlandsat[['swir22', 'nir08', 'red']].to_array().fillna(0).plot.imshow(ax=ax, robust = True)\n\n# Add fire perimeters\npalisades_fire.plot(ax=ax,\n                    color = \"none\",\n                    edgecolor = \"darkred\",\n                   linewidth = 1.2)\n\neaton_fire.plot(ax=ax,\n               color = \"none\",\n                edgecolor = \"darkred\",\n                linewidth = 1.2)\n\n# Title\nax.set_title(\"False Color Image of Palisades and Eaton Fires, \\n Los Angeles County (2025)\",\n            size = 13)\n\n# Remove axes ticks\nax.set_xticks([])\nax.set_yticks([])\n\n# Remove axes labels\nax.set_xlabel(\"\")  \nax.set_ylabel(\"\")  \n\n# Add fire names as text annotations\nax.text(palisades_fire.geometry.centroid.iloc[0].x - 6000,\n        palisades_fire.geometry.centroid.iloc[0].y + 9000,\n        \"Palisades Fire\",\n        color = \"white\",\n        fontsize = 8,\n        ha = 'right',\n        bbox = dict(facecolor='black', alpha=0.8, edgecolor='none', pad=2, boxstyle= \"round, pad=0.3\"))\n\nax.text(eaton_fire.geometry.centroid.iloc[0].x - 1000,\n        eaton_fire.geometry.centroid.iloc[0].y - 1000,\n        \"Eaton Fire\",\n        color = 'white',\n        fontsize = 8,\n        ha = 'right',\n        bbox = dict(facecolor='black', alpha=0.8, edgecolor='none', pad=2, boxstyle= \"round, pad=0.3\"))\n\n# Add figure caption\nplt.figtext(0.12, 0.13, \" This false color image highlights the fire scars of the Palisades and Eaton Fires in Los Angeles County, California in early January \\n 2025. Assigning SWIR, NIR, and red bands to visible colors helps to increase the visibility of the effects of the fires, such as burn \\n severity and vegetation health compared to surrounding areas.\\n \\n Data Sources: City of Los Angeles GeoHub and Landsat \\n Accessed Nov. 20, 2025\", fontsize = 8.5)\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-17-output-1.png){width=768 height=536}\n:::\n:::\n\n\nIn this analysis, we were able to process data in the form of shapefiles and a NetCDF in order to create a false color image showing fire burn scars. The Palisades and Eaton Fires clearly had an effect on the environment shown in our map, as these red areas contrast with the surrounding green.\n\n## Social dimensions of Eaton and Palisades fires\n\nNext, we want to look at the distribution of a socioeconomic variable within the bounds of the fires to better understand how the fires might have impacted different groups within the communities. One of the variables included in the Environmental Justice Index is the percentage of of persons without internet within each census tract. \n\n### 1. EJI data exploration\n\nFirst, we want to import the EJI data and do some initial exploration. \n\n::: {#ab47c4ee .cell execution_count=17}\n``` {.python .cell-code code-fold=\"true\"}\n# Load EJI data\nfp = os.path.join('data', 'EJI_2024_California', 'EJI_2024_California.gdb')\neji = gpd.read_file(fp)\n\n# Check geometry type\nprint('Geometry type:', eji.geom_type.iloc[0])\n\n# Ensure the CRSs of all data sets match\neji = eji.to_crs(epsg = 3857)\npalisades = palisades_fire.to_crs(epsg = 3857)\neaton = eaton_fire.to_crs(epsg = 3857)\n\n# Confirm changes\nprint('Palisades and EJI CRS match?:', palisades.crs == eji.crs)\nprint('Eaton and EJI CRS match?:', eaton.crs == eji.crs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGeometry type: MultiPolygon\nPalisades and EJI CRS match?: True\nEaton and EJI CRS match?: True\n```\n:::\n:::\n\n\nWe need to spatially join the EJI data with the fire perimeters based on the geometry column, so we use an inner join to keep only the rows from EJI that intersect with the fire perimeter polygons.\n\n::: {#745cbc33 .cell execution_count=18}\n``` {.python .cell-code code-fold=\"true\"}\n# Spatially join EJI data with fire perimeters on geometry column\ncensus_within_palisades = gpd.sjoin(eji, palisades, how = 'inner', predicate = 'intersects')\ncensus_within_eaton = gpd.sjoin(eji, eaton, how = 'inner', predicate = 'intersects')\n```\n:::\n\n\nOur data now contains both fire perimeter and EJI data.\n\n::: {#e9232b86 .cell execution_count=19}\n``` {.python .cell-code code-fold=\"true\"}\n# Confirm join\ncensus_within_palisades.head(3)\n```\n\n::: {.cell-output .cell-output-display execution_count=42}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>OBJECTID_left</th>\n      <th>STATEFP</th>\n      <th>COUNTYFP</th>\n      <th>TRACTCE</th>\n      <th>AFFGEOID</th>\n      <th>GEOID</th>\n      <th>GEOID_2020</th>\n      <th>COUNTY</th>\n      <th>StateDesc</th>\n      <th>STATEABBR</th>\n      <th>...</th>\n      <th>Tribe_Names</th>\n      <th>Tribe_Flag</th>\n      <th>Shape_Length</th>\n      <th>Shape_Area</th>\n      <th>geometry</th>\n      <th>index_right</th>\n      <th>OBJECTID_right</th>\n      <th>type</th>\n      <th>Shape__Are</th>\n      <th>Shape__Len</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1328</th>\n      <td>6505</td>\n      <td>06</td>\n      <td>037</td>\n      <td>262706</td>\n      <td>140000US06037262706</td>\n      <td>06037262706</td>\n      <td>06037262706</td>\n      <td>Los Angeles County</td>\n      <td>California</td>\n      <td>CA</td>\n      <td>...</td>\n      <td>-999</td>\n      <td>-999</td>\n      <td>6486.563559</td>\n      <td>2.147847e+06</td>\n      <td>MULTIPOLYGON (((-13195148.412 4033844.678, -13...</td>\n      <td>0</td>\n      <td>1</td>\n      <td>Heat Perimeter</td>\n      <td>1182.082031</td>\n      <td>267.101144</td>\n    </tr>\n    <tr>\n      <th>1328</th>\n      <td>6505</td>\n      <td>06</td>\n      <td>037</td>\n      <td>262706</td>\n      <td>140000US06037262706</td>\n      <td>06037262706</td>\n      <td>06037262706</td>\n      <td>Los Angeles County</td>\n      <td>California</td>\n      <td>CA</td>\n      <td>...</td>\n      <td>-999</td>\n      <td>-999</td>\n      <td>6486.563559</td>\n      <td>2.147847e+06</td>\n      <td>MULTIPOLYGON (((-13195148.412 4033844.678, -13...</td>\n      <td>1</td>\n      <td>2</td>\n      <td>Heat Perimeter</td>\n      <td>2222.488281</td>\n      <td>185.498783</td>\n    </tr>\n    <tr>\n      <th>1328</th>\n      <td>6505</td>\n      <td>06</td>\n      <td>037</td>\n      <td>262706</td>\n      <td>140000US06037262706</td>\n      <td>06037262706</td>\n      <td>06037262706</td>\n      <td>Los Angeles County</td>\n      <td>California</td>\n      <td>CA</td>\n      <td>...</td>\n      <td>-999</td>\n      <td>-999</td>\n      <td>6486.563559</td>\n      <td>2.147847e+06</td>\n      <td>MULTIPOLYGON (((-13195148.412 4033844.678, -13...</td>\n      <td>2</td>\n      <td>3</td>\n      <td>Heat Perimeter</td>\n      <td>21.011719</td>\n      <td>22.412814</td>\n    </tr>\n  </tbody>\n</table>\n<p>3 rows × 179 columns</p>\n</div>\n```\n:::\n:::\n\n\nWhen plotting this joined data, we see that the census tracts that were kept due to an intersection cover far more space than the fire perimeters, shown in dark red. \n\n::: {#d3359849 .cell execution_count=20}\n``` {.python .cell-code code-fold=\"true\"}\n# Create exploratory map \nfig, ax = plt.subplots(figsize=(9,5), nrows = 1, ncols = 2)\n\ncensus_within_palisades.plot(ax=ax[0], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 0.5)\npalisades.boundary.plot(ax=ax[0], color = 'darkred')\ncensus_within_eaton.plot(ax=ax[1], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 0.5)\neaton.boundary.plot(ax=ax[1], color = 'darkred')\n\nfor a in ax:\n  a.axis('off')\n  \n# Add legends\nlegend_elements = [\n    Patch(facecolor = 'darkred', edgecolor = 'darkred', label = 'Fire perimeters'),\n    Patch(facecolor = 'darkblue', edgecolor = 'darkblue', label = 'Census tract boundaries')\n]\n\nax[0].legend(handles = legend_elements, loc = 'upper left', bbox_to_anchor=(-0.2, 1.05), fontsize = 8)\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-21-output-1.png){width=744 height=239}\n:::\n:::\n\n\n### 3. Polygon clipping\n\nTo further reduce the census tracts to the fire perimeter boundaries, we will clip the census tracts to Palisades and Eaton fire perimeter using `geopandas.clip()`.\n\n::: {#47b2542e .cell execution_count=21}\n``` {.python .cell-code code-fold=\"true\"}\npalisades_clipped = gpd.clip(census_within_palisades, palisades)\neaton_clipped = gpd.clip(census_within_eaton, eaton)\n```\n:::\n\n\n::: {#de8b0204 .cell execution_count=22}\n``` {.python .cell-code code-fold=\"true\"}\n# Create exploratory map \nfig, ax = plt.subplots(figsize=(9,5), nrows = 1, ncols = 2)\n\npalisades.boundary.plot(ax=ax[0], color = 'darkred')\npalisades_clipped.plot(ax=ax[0], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 0.5)\neaton.boundary.plot(ax=ax[1], color = 'darkred')\neaton_clipped.plot(ax=ax[1], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 0.5)\n\nfor a in ax:\n  a.axis('off')\n  \n# Add legends\nlegend_elements = [\n    Patch(facecolor = 'darkred', edgecolor = 'darkred', label = 'Fire perimeters'),\n    Patch(facecolor = 'darkblue', edgecolor = 'darkblue', label = 'Census tract boundaries')\n]\n\nax[0].legend(handles = legend_elements, loc = 'upper left', bbox_to_anchor=(-0.2, 1.05), fontsize = 8)\n\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-23-output-1.png){width=744 height=219}\n:::\n:::\n\n\n### 5. Visualize EJI data\nLastly, we can use these clipped polygons to visualize the values of our variable of interest (percentage of persons without internet) within the census tracts within the fire perimeters.\n\n::: {#c9ba7e29 .cell execution_count=23}\n``` {.python .cell-code code-fold=\"true\"}\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 5))\n\n# Include our EJI variable\neji_variable = 'E_NOINT'\n\n# Find common min/max for legend range\nvmin = min(census_within_palisades[eji_variable].min(), census_within_eaton[eji_variable].min())\nvmax = max(census_within_palisades[eji_variable].max(), census_within_eaton[eji_variable].max())\n\n# Plot census tracts within Palisades perimeter\npalisades_clipped.plot(\n    column= eji_variable,\n    cmap = 'PuBuGn',\n    vmin=vmin, vmax=vmax,\n    legend=False,\n    ax=ax1,\n)\nax1.set_title('Palisades Fire')\nax1.axis('off')\n\n# Plot census tracts within Eaton perimeter\neaton_clipped.plot(\n    column=eji_variable,\n    cmap = 'PuBuGn',\n    vmin=vmin, vmax=vmax,\n    legend=False,\n    ax=ax2,\n)\nax2.set_title('Eaton Fire')\nax2.axis('off')\n\n# Add overall title\nfig.suptitle('Percentage of Persons Without Internet - Fire Areas Comparison')\n\n# Add shared colorbar at the bottom\nsm = plt.cm.ScalarMappable(cmap= 'PuBuGn', norm=plt.Normalize(vmin=vmin, vmax=vmax))\ncbar_ax = fig.add_axes([0.25, 0.08, 0.5, 0.02])  # [left, bottom, width, height]\ncbar = fig.colorbar(sm, cax=cbar_ax, orientation='horizontal')\ncbar.set_label('Persons without internet (%)')\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-24-output-1.png){width=763 height=492}\n:::\n:::\n\n\nBased upon this map, we can see that some areas, especially within the Eaton Fire perimeter, had percentages of people without internet as high as 16%. Targeting these census tracts for wildfire resilience programs such as providing pre-planned courses of action when signs of fire are noticed or a list of places to notify using alternative methods in the case of a fire would be beneficial.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}