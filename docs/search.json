[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Here’s where I describe what I do professionally"
  },
  {
    "objectID": "about.html#what-i-do-for-work",
    "href": "about.html#what-i-do-for-work",
    "title": "About",
    "section": "",
    "text": "Here’s where I describe what I do professionally"
  },
  {
    "objectID": "about.html#what-i-do-for-fun",
    "href": "about.html#what-i-do-for-fun",
    "title": "About",
    "section": "What I do for fun",
    "text": "What I do for fun\nHere’s what I do for fun"
  },
  {
    "objectID": "posts/2025-12-01-eds223/index.html",
    "href": "posts/2025-12-01-eds223/index.html",
    "title": "EDS 223: Houston Power Grids",
    "section": "",
    "text": "CitationBibTeX citation:@online{robillard2025,\n  author = {Robillard, Ava},\n  title = {EDS 223: {Houston} {Power} {Grids}},\n  date = {2025-12-01},\n  url = {https://avarobillard.github.io/posts/2025-12-01-eds223},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nRobillard, Ava. 2025. “EDS 223: Houston Power Grids.”\nDecember 1, 2025. https://avarobillard.github.io/posts/2025-12-01-eds223."
  },
  {
    "objectID": "posts/2025-12-01-eds220/index.html",
    "href": "posts/2025-12-01-eds220/index.html",
    "title": "EDS 220: Eaton and Palisades Fires",
    "section": "",
    "text": "The Palisades Eaton Fires occurred in early January 2025 in very populated areas of Los Angeles County, California. Both fires began on January 7th and burned a total of about 37,469 acres (Starr and Morton 2025).\nIn this blog, we will walk through how to create a false color image using Landsat remote sensing and fire perimeter data to highlight the locations of the Palisades and Eaton Fires. We will also look at socioeconomic risk factors that could influence a community’s response to a wildfire in the form of a chloropleth map."
  },
  {
    "objectID": "posts/2025-12-01-eds220/index.html#social-dimensions-of-eaton-and-palisades-fires",
    "href": "posts/2025-12-01-eds220/index.html#social-dimensions-of-eaton-and-palisades-fires",
    "title": "EDS 220: Eaton and Palisades Fires",
    "section": "Social dimensions of Eaton and Palisades fires",
    "text": "Social dimensions of Eaton and Palisades fires\nNext, we want to look at the distribution of a socioeconomic variable within the bounds of the fires to better understand how the fires might have impacted different groups within the communities. One of the variables included in the Environmental Justice Index is the percentage of of persons without internet within each census tract.\n\n1. EJI data exploration\nFirst, we want to import the data and do some initial exploration.\n\n\nCode\n# Load EJI data\nfp = os.path.join('data', 'EJI_2024_California', 'EJI_2024_California.gdb')\neji = gpd.read_file(fp)\n\n# Load Palisades fire boundary\nfp = os.path.join('data', 'Palisades_Perimeter_20250121', 'Palisades_Perimeter_20250121.shp')\npalisades = gpd.read_file(fp)\n\n# Load Eaton fire boundary\nfp = os.path.join('data', 'Eaton_Perimeter_20250121', 'Eaton_Perimeter_20250121.shp')\neaton = gpd.read_file(fp)\n\n\n\n\nCode\n# Check geometry type\nprint('Geometry type:', eji.geom_type.iloc[0])\n\n\nGeometry type: MultiPolygon\n\n\n\n\nCode\n# Ensure the CRSs of all data sets match\neji = eji.to_crs(epsg = 3857)\n\n# Confirm changes\nprint('Palisades and EJI CRS match?:', palisades.crs == eji.crs)\nprint('Eaton and EJI CRS match?:', eaton.crs == eji.crs)\n\n\nPalisades and EJI CRS match?: True\nEaton and EJI CRS match?: True\n\n\nWe need to spatially join the EJI data with the fire perimeters based on the geometry column, so we use an inner join to keep only the rows from EJI that intersect with the fire perimeter polygons.\n\n\nCode\n# Spatially join EJI data with fire perimeters on geometry column\ncensus_within_palisades = gpd.sjoin(eji, palisades, how = 'inner', predicate = 'intersects')\ncensus_within_eaton = gpd.sjoin(eji, eaton, how = 'inner', predicate = 'intersects')\n\n\nOur data now contains both fire perimeter and EJI data.\n\n\nCode\n# Confirm join\ncensus_within_palisades.head(3)\n\n\n\n\n\n\n\n\n\nOBJECTID_left\nSTATEFP\nCOUNTYFP\nTRACTCE\nAFFGEOID\nGEOID\nGEOID_2020\nCOUNTY\nStateDesc\nSTATEABBR\n...\nTribe_Names\nTribe_Flag\nShape_Length\nShape_Area\ngeometry\nindex_right\nOBJECTID_right\ntype\nShape__Are\nShape__Len\n\n\n\n\n1328\n6505\n06\n037\n262706\n140000US06037262706\n06037262706\n06037262706\nLos Angeles County\nCalifornia\nCA\n...\n-999\n-999\n6486.563559\n2.147847e+06\nMULTIPOLYGON (((-13195148.084 4033844.651, -13...\n0\n1\nHeat Perimeter\n1182.082031\n267.101144\n\n\n1328\n6505\n06\n037\n262706\n140000US06037262706\n06037262706\n06037262706\nLos Angeles County\nCalifornia\nCA\n...\n-999\n-999\n6486.563559\n2.147847e+06\nMULTIPOLYGON (((-13195148.084 4033844.651, -13...\n1\n2\nHeat Perimeter\n2222.488281\n185.498783\n\n\n1328\n6505\n06\n037\n262706\n140000US06037262706\n06037262706\n06037262706\nLos Angeles County\nCalifornia\nCA\n...\n-999\n-999\n6486.563559\n2.147847e+06\nMULTIPOLYGON (((-13195148.084 4033844.651, -13...\n2\n3\nHeat Perimeter\n21.011719\n22.412814\n\n\n\n\n3 rows × 179 columns\n\n\n\nWhen plotting this joined data, we see that the census tracts that were kept due to an intersection cover far more space than the fire perimeters, shown in dark red.\n\n\nCode\n# Create exploratory map \nfig, ax = plt.subplots(figsize=(9,5), nrows = 1, ncols = 2)\n\ncensus_within_palisades.plot(ax=ax[0], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 0.5)\npalisades.boundary.plot(ax=ax[0], color = 'darkred')\ncensus_within_eaton.plot(ax=ax[1], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 0.5)\neaton.boundary.plot(ax=ax[1], color = 'darkred')\n\nfor a in ax:\n  a.axis('off')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n3. Polygon clipping\nTo further reduce the census tracts to the fire perimeter boundaries, we will clip the census tracts to Palisades and Eaton fire perimeter using geopandas.clip().\n\n\nCode\npalisades_clipped = gpd.clip(census_within_palisades, palisades)\neaton_clipped = gpd.clip(census_within_eaton, eaton)\n\n\n\n\nCode\n# Create exploratory map \nfig, ax = plt.subplots(figsize=(9,5), nrows = 1, ncols = 2)\n\npalisades_clipped.plot(ax=ax[0], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 1.5)\neaton_clipped.plot(ax=ax[1], color = \"lightblue\", edgecolor = \"darkblue\", linewidth = 1.5)\n\nfor a in ax:\n  a.axis('off')\n\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n5. Visualize EJI data\nLastly, we can use these clipped polygons to visualize the values of our variable of interest (percentage of persons without internet) within the census tracts within the fire perimeters.\n\n\nCode\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 5))\n\n# Include our EJI variable\neji_variable = 'E_NOINT'\n\n# Find common min/max for legend range\nvmin = min(census_within_palisades[eji_variable].min(), census_within_eaton[eji_variable].min())\nvmax = max(census_within_palisades[eji_variable].max(), census_within_eaton[eji_variable].max())\n\n# Plot census tracts within Palisades perimeter\npalisades_clipped.plot(\n    column= eji_variable,\n    cmap = 'PuBuGn',\n    vmin=vmin, vmax=vmax,\n    legend=False,\n    ax=ax1,\n)\nax1.set_title('Palisades Fire')\nax1.axis('off')\n\n# Plot census tracts within Eaton perimeter\neaton_clipped.plot(\n    column=eji_variable,\n    cmap = 'PuBuGn',\n    vmin=vmin, vmax=vmax,\n    legend=False,\n    ax=ax2,\n)\nax2.set_title('Eaton Fire')\nax2.axis('off')\n\n# Add overall title\nfig.suptitle('Percentage of Persons Without Internet - Fire Areas Comparison')\n\n# Add shared colorbar at the bottom\nsm = plt.cm.ScalarMappable(cmap= 'PuBuGn', norm=plt.Normalize(vmin=vmin, vmax=vmax))\ncbar_ax = fig.add_axes([0.25, 0.08, 0.5, 0.02])  # [left, bottom, width, height]\ncbar = fig.colorbar(sm, cax=cbar_ax, orientation='horizontal')\ncbar.set_label('Persons without internet (%)')\n\nplt.show()\n\n\n\n\n\n\n\n\n\nBased upon this map, we can see that some areas, especially within the Eaton Fire perimeter, had percentages of people without internet as high as 16%. Targeting these census tracts for wildfire resilience programs such as providing pre-planned courses of action when signs of fire are noticed or a list of places to notify using alternative methods in the case of a fire would be beneficial."
  },
  {
    "objectID": "posts/2025-12-01-eds222/index.html",
    "href": "posts/2025-12-01-eds222/index.html",
    "title": "EDS 222: Herbarium Specimen Phenology",
    "section": "",
    "text": "Many studies have found climate-related delays in the timing of leaf coloration, but do not have a lot of data from before the late 20th century (Garretson and Forkner 2021b).\nA data set collected by Garretson and Forkner in 2021 from the Southeast Regional Network of Expertise and Collections (SERNEC n.d.) contains evaluations of 2,972 digitized herbaria specimens of red and sugar maples collected between 1826 and 2016. They paired these specimens with climate and locality information to investigate long-term trends in autumn phenology over the past century (Garretson and Forkner 2021a).\nUsing this data, I want to analyze the effects of day of year (doy), year, and mean fall temperature on the presence of colored leaves as well as determine whether the day of the year when there becomes a higher probability of leaf color is shifting earlier over time.\n\n\n\n\nDAG\n\n\n\nI think that year, day of the year, and mean fall temperature all have an effect on whether a leaf is colored. Day of year is a seasonal relationship, where leaf coloration is expected the least in the summer (~180-250 doy) and more after that period in the fall (~250-300 doy). Cooler fall temperatures could cause a quicker onset of leaf coloration and senescence, while warmer mean temperatures could delay it. Year also could have an effect on how day of the year affects leaf coloration, as over time the day of year that is associated with higher probabilities of leaf coloration could shift. Year could also affect mean fall temperatures, as some years are generally warmer or cooler than others.\n\n\n\n\nCode\nlibrary(here)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(segmented)\nlibrary(kableExtra)\nlibrary(broom)\nlibrary(gtsummary)\nlibrary(modelsummary)\n\n# Read in data\nautumn_data &lt;- read_csv(here::here(\"posts\", \"2025-12-01-eds222\", \"data\", \"autumn_data.csv\")) %&gt;% \n  clean_names() \n\n\n\n\n\n\n\nCode\nggplot(autumn_data, aes(x = longitude, y = latitude)) +\n  geom_point(alpha = 0.5, color = \"darkgreen\") +\n  labs(x = \"Longitude\", y = \"Latitude\", \n       title = \"Herbarium Specimen Locations\") +\n  theme_minimal()\n\n\n\n\n\nFigure 1: Initial exploration of the spatial distribution of Herbarium specimens.\n\n\n\n\nThe specimens are located relatively uniformly throughout the Northeast.\n\n\nCode\n# Create scatter plot\nggplot(autumn_data, aes(x = doy, y = colored_leaves, color = species)) +\n  geom_jitter(alpha = 0.5, width = 0, height = 0.1) +\n  scale_color_manual(values = c(\"#6F8FAF\", \"#8A9A5B\")) +\n  labs(x = \"Day of year\",\n       y = \"Colored leaves\") +\n  theme_minimal() \n\n\n\n\n\nFigure 2: Initial exploration of the effects of day of the year on the presence of colored leaves (0/1).\n\n\n\n\nThe binary colored_leaves variable appears to have many more specimens with non-colored leaves, which are spread throughout the entire year but show a cluster between about doy 80 and 300. There are fewer specimens with colored leaves, with a more concentrated spread between doy 100 and 320. This data distribution suggests that a logistic regression model could be a good fit.\n\n\nCode\n# Filter data to a few years to visualize this over time\nautumn_data_decades &lt;- autumn_data %&gt;% \n  filter(year %in% c(1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020))\n\n# Create scatter plot\nggplot(autumn_data_decades, aes(x = doy, y = colored_leaves, color = year)) +\n  geom_jitter(alpha = 0.6, width = 0, height = 0.1) +\n  scale_color_gradientn(colors = c(\"#FFBF00\", \"orange\",\"#CC5500\", \"#C41E3A\", \"#660033\"), guide = \"none\") +\n  labs(x = \"Day of year\",\n       y = \"Colored leaves\") +\n  facet_wrap(~year) +\n  theme_minimal() \n\n\n\n\n\nFigure 3: Initial exploration of the effects of day of the year on the presence of colored leaves (0/1).\n\n\n\n\nThis plot shows that there are relatively few colored leaf data points in each year of observation, which might create a challenge when trying to draw conclusions.\n\n\n\nAfter exploring the data, I want to fit a binomial model with day of year, year, and mean fall temperature as predictors and colored leaves as a binary response.\n\n# Binomial model\nbin_model &lt;- glm(colored_leaves ~ doy + year + mean_fall,\n                 data = autumn_data,\n                 family = binomial(link = \"logit\"))\n\n\n\nCode\n# Create coefficient table\ntidy(bin_model) %&gt;%\n  kable(digits = 3, caption = \"Coefficient Estimates for Binomial Model\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Estimates for Binomial Model\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n1.348\n3.469\n0.389\n0.697\n\n\ndoy\n0.013\n0.001\n14.664\n0.000\n\n\nyear\n-0.003\n0.002\n-1.745\n0.081\n\n\nmean_fall\n0.029\n0.028\n1.054\n0.292\n\n\n\n\n\nOnly the day of year variable is significant, with a p-value below 0.05. The positive coefficients for doy and mean_fall could indicate that the probability of colored leaves increases later in the year and with warmer fall temperatures. The slightly negative sign of year indicates that the probability of colored leaves decreases in some way each year.\n\n\n\nNext, I want to look at the model fit over a selection of years to better visualize whether doy where probability of colored leaves shifts from 0 to 1 becomes earlier over time. Setting mean_fall to the average allows us to focus on the relationship between day of year and year on leaf coloration.\n\n\nCode\n# Pick four years to model\nyears &lt;- c(1900, 1940, 1980, 2020)\n\n# Make data frame of predictors using means for fixed variables\npred_grid &lt;- expand_grid(\n  doy = 1:365,\n  year = years,\n) %&gt;% \n  mutate(\n    mean_fall = mean(autumn_data$mean_fall, na.rm = TRUE)\n  )\n\n# Generate predictions using model- just best estimate\nbin_model_pred &lt;- pred_grid %&gt;% \n  mutate(p = predict(object = bin_model,\n                     newdata = pred_grid,\n                     type = \"response\"))\n\n\n\n\nCode\n# Plot predictions for three years \nggplot(bin_model_pred, aes(x = doy, y = p, color = factor(year))) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  scale_color_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  labs(color = \"Year\", y = \"p\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe can also transition between link and response space to visualize this plot with confidence intervals.\n\n\nCode\n# Create confidence interval\nbin_model_se &lt;- predict(object = bin_model,\n                          newdata = pred_grid,\n                          type = \"link\", # stay in link space!\n                          se.fit = TRUE) # get the se of the fit\n\n# Go from link space to response space\nlinkinv &lt;- family(bin_model)$linkinv\n\nbin_model_pred_l &lt;- pred_grid %&gt;% \n  mutate(\n    # get logit(p)\n    logit_p = bin_model_se$fit,\n    # 95% CI in link space- keeps in realistic range of values!! can do math here\n    logit_p_se = bin_model_se$se.fit,\n    logit_p_lwr = qnorm(0.025, mean = logit_p, sd = logit_p_se),\n    logit_p_upr = qnorm(0.975, mean = logit_p, sd = logit_p_se),\n    # undo the link function using linkinv- can interpret here\n    p = linkinv(logit_p),\n    p_lwr = linkinv(logit_p_lwr),\n    p_upr = linkinv(logit_p_upr)\n  )\n\n# filter predictions to a few years\nbin_model_pred_l_filtered &lt;- bin_model_pred_l %&gt;%\n  filter(year %in% c(1900, 1940, 1980, 2020)) %&gt;%\n  mutate(year = factor(year))\n\n# plot \nggplot(bin_model_pred_l_filtered, aes(x = doy, y = p, fill = year))+\n  geom_ribbon(aes(ymin = p_lwr, ymax = p_upr), alpha = 0.2) +\n  scale_fill_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nBased on this figure, the day of year where leaf coloration probability is 0.5 is shifting to the right from 1900 to 2020, or becoming later in the year over time.\nTo see if my results will change due to seasonality and when colored leaves are most probable, I want to make mid-summer associated with 0 as this is when there is most likely to be 0 colored leaves, and shift the other days of the year accordingly. I also want to group the data by decade to create more data points for plotting, to correct for the issues seen in Figure 3 of my data exploration.\n\n# Mutate data \nautumn_data_decadegroups &lt;- autumn_data %&gt;% \n  mutate(doy_summer = (doy - 180) %% 365,\n         decade = floor(year/10) * 10) \n\n\n# Fit model based on mutated data\nbin_model_summer &lt;- glm(colored_leaves ~ doy_summer + decade + mean_fall,\n                 data = autumn_data_decadegroups,\n                 family = binomial(link = \"logit\"))\n\n\n\nCode\n# Create coefficient table\ntidy(bin_model_summer) %&gt;%\n  kable(digits = 3, caption = \"Coefficient Estimates for Binomial Decade Model\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Estimates for Binomial Decade Model\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n2.704\n3.266\n0.828\n0.408\n\n\ndoy_summer\n-0.003\n0.000\n-6.915\n0.000\n\n\ndecade\n-0.002\n0.002\n-1.280\n0.201\n\n\nmean_fall\n0.021\n0.026\n0.811\n0.417\n\n\n\n\n\nOnly day of year continued to be statistically significant, but in contrast to the previous model is negative. Let’s see what this looks like plotted!\n\n\nCode\n# Pick four decades to model\ndecades &lt;- c(1900, 1940, 1980, 2010)\n\n# Make data frame of predictors using means for fixed variables\npred_grid2 &lt;- expand_grid(\n  doy_summer = 1:365,\n  decade = decades,\n) %&gt;% \n  mutate(\n    mean_fall = mean(autumn_data_decadegroups$mean_fall, na.rm = TRUE)\n  )\n\n# Generate predictions using model- just best estimate\nbin_model_pred2 &lt;- pred_grid2 %&gt;% \n  mutate(p = predict(object = bin_model_summer,\n                     newdata = pred_grid2,\n                     type = \"response\"))\n\n\n\n\nCode\n# Plot predictions for four decades\nggplot(bin_model_pred2, aes(x = doy_summer, y = p, color = factor(decade))) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  labs(color = \"Decade\", y = \"p\") +\n  scale_color_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThis plot shows a negative trend in leave coloration probability over time with a starting point of mid summer.\n\n\n\nNext, I want to try to use a segmented model to look at the rate of change between these curves and determine whether the doy at which the probability of having colored leaves increases shifts back at a faster rate after a certain year break point.\n\\[\n\\text{BinaryOutcome} \\sim \\text{Binomial}(1, p)\n\\]\n\\[\n\\text{logit}(p) =\n\\beta_0 + \\beta_1 \\cdot \\text{doy} + \\beta_2 \\cdot \\text{year} + \\beta_3 \\cdot \\text{year} \\cdot \\text{after} + \\beta_4 \\cdot \\text{meanfall}\n\\]\n\\[\n\\text{after}=\n\\begin{cases}\n0 & \\text{if year} \\le \\psi \\\\\n1 & \\text{if year} &gt; \\psi\n\\end{cases}\n\\]\nA segmented model allows for a change in the relationship between response and explanatory variables at a breakpoint, where beta 3 gets added to the slope of beta 2 if the year is beyond the breakpoint (Kaizer n.d.). Based on this idea, I set up my hypotheses:\n\n\n\nNull hypothesis (H0): One slope describes the effect of year on leaf coloration (slopes are the same before and after breakpoint)\n\nH0: \\(\\beta_3 = 0\\)\n\nAlternative hypothesis (Ha): Multiple slopes describe the effect of year on leaf coloration (slopes are different before and after breakpoint)\n\nHa: \\(\\beta_3 \\neq 0\\)\nBefore applying this model to my actual data, we can use a simplified model to simulate data from and better understand how a segmented model works:\n\\[\n\\text{BinaryOutcome} \\sim \\text{Binomial}(1, p)\n\\]\n\\[\n\\text{logit}(p) =\n\\beta_0 + \\beta_1 \\cdot \\text{x} + \\beta_2 \\cdot \\text{x} \\cdot \\text{afterbreakpoint}\n\\]\nWhere afterbreakpoint is a binary variable where 0 corresponds to before the determined breakpoint and 1 is after. This allows us to have the different slopes depending upon where we are along the x-axis. This difference in slopes is beta 2.\nWe will use these steps:\n\nChoose a set of parameters and predictor variable(s) for the simulation\n\n\n\nCode\nset.seed(123)\n\n# 1. Choose a set of parameters \nbeta0 &lt;- 0\nbeta1 &lt;- 0.4\nbeta2 &lt;- 0.5\n\n# Create x values\nx_before &lt;- seq(0, 20, length.out = 1000)\n\n# Want breakpoint to be the middle @ x = 10\n# Subtract 10 from every x value\nx &lt;- x_before - 10\n\n# Create breakpoint indicator- now @ x = 0 \n# make this 0 if x is negative and 1 if x is positive\nafterbreakpoint &lt;- case_when(\n  x &lt; 0 ~ 0,\n  x &gt;= 0 ~ 1\n)\n\n\n\nUse a random variable to generate a response, based on the parameters and predictor(s)\n\n\n\nCode\n# Write out formula based on model notation\nlogit_p &lt;- beta0 + beta1*x + beta2*(x*afterbreakpoint)\n\np &lt;- exp(logit_p) / (1 + exp(logit_p))\n\n# 2. Use a random variable to generate Binary outcomes\ny &lt;- rbinom(n = length(p), size = 1, prob = p)\n\n# Create full simulated data\nsim_dat &lt;- tibble(x, afterbreakpoint, y) \n\n\n\nFit a model to the simulated data\n\n\n\nCode\n# 3. Fit model to simulated data\nsim_mod &lt;- glm(y ~ x + x:afterbreakpoint,\n                 data = sim_dat,\n                 family = binomial(link = \"logit\"))\n\n\n\nCheck if the model’s parameter estimates match selected parameters\n\n\n\nCode\n# 4. Check if model's parameters match \nmod_summ &lt;- summary(sim_mod)\nbeta_0_hat &lt;- coef(sim_mod)[1]\nbeta_1_hat &lt;- coef(sim_mod)[2]\nbeta_2_hat &lt;- coef(sim_mod)[3]\n\n# Create kable table with values for comparison\ncomparison_table &lt;- rbind(\n  Selected = round(c(beta0, beta1, beta2), 2),\n  Model = round(c(beta_0_hat, beta_1_hat, beta_2_hat), 2))\n\ncolnames(comparison_table) &lt;- c(\"Beta 0\", \"Beta 1\", \"Beta 2\")\n\nkable(comparison_table, caption = \"Coefficient Comparisons\", align = \"c\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Comparisons\n\n\n\nBeta 0\nBeta 1\nBeta 2\n\n\n\n\nSelected\n0.00\n0.40\n0.5\n\n\nModel\n-0.02\n0.42\n0.4\n\n\n\n\n\nThe Intercept (beta 0) was very close to the selected value of 0, and the x (beta 1) was very close to the selected value of 0.4. The x associated with being after the breakpoint (beta 2) was slightly lower than the selected value of 0.5.\n\n\n\n\nNow, I want to apply a segmented model to my original binomial model at an estimated break point in 1980.\n\n# Segmented model using initial binomial model\nseg_model &lt;- segmented(bin_model, seg.Z = ~year, psi = list(year = 1980))\n\n\n\nCode\n# Create coefficient table\ntidy(seg_model) %&gt;%\n  kable(digits = 3, caption = \"Coefficient Estimates for Segmented Model\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Estimates for Segmented Model\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n-9.523\n7.893\n-1.207\n0.228\n\n\ndoy\n0.013\n0.001\n14.603\n0.000\n\n\nyear\n0.003\n0.004\n0.616\n0.538\n\n\nmean_fall\n0.027\n0.028\n0.978\n0.328\n\n\nU1.year\n-0.015\n0.007\n-2.040\n0.041\n\n\npsi1.year\n0.000\n14.130\n0.000\n1.000\n\n\n\n\n\n\n\nCode\nseg_ci &lt;- confint(seg_model)\n\n# Convert to data frame for kable\nci_table &lt;- as.data.frame(seg_ci)\nci_table$Term &lt;- rownames(ci_table)\ncolnames(ci_table) &lt;- c(\"Est.\", \"Lower\", \"Upper\")  \n\n# Reorder columns \nci_table &lt;- ci_table[, c(\"Est.\", \"Lower\", \"Upper\")]\n\n# Round and make table\nci_table %&gt;%\n  round(2) %&gt;%\n  kable(caption = \"Segmented Model 95% Confidence Intervals\", align = \"c\") %&gt;%\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\n\n\n\nSegmented Model 95% Confidence Intervals\n\n\n\nEst.\nLower\nUpper\n\n\n\n\npsi1.year\n1968\n1940.29\n1995.71\n\n\n\n\n\nThe estimated break point (where the slope of year changes) was in 1968, with a standard error of about 14 years ranging between 1940 and 1996 (the 95% CI). This is quite a large range! The coefficients for doy, year, and mean_fall were all slightly positive, but only doy was significant, indicating that the the probability of colored leaves increases later in the year. The estimate for U1.year, or the change in slope after the breakpoint, was -0.0145. Subtracting this value from the original slope for year (beta 2, 0.0025), the estimated slope after the breakpoint was -0.012. In context, the slope for year changed from slightly positive to slightly negative after the breakpoint in 1968.\n\n\nCode\n# Make data frame of predictors using means for fixed variables\npred_grid &lt;- expand_grid(\n  doy = 1:365,\n  year = years\n) %&gt;% \n  mutate(\n    mean_fall = mean(autumn_data$mean_fall, na.rm = TRUE),\n    annual_precip = mean(autumn_data$annual_precip, na.rm = TRUE)\n  )\n\n# Generate predictions using model- just best estimate\nseg_model_pred &lt;- pred_grid %&gt;% \n  mutate(p = predict(object = seg_model,\n                     newdata = pred_grid,\n                     type = \"response\"))\n\n\n\n\nCode\n# Plot predictions for three years \nggplot(seg_model_pred, aes(x = doy, y = p, color = factor(year))) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  scale_color_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  labs(color = \"Year\", y = \"p\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n2020 has a clearly lower slope than the other years, indicating the probability of colored leaves being lower further into the year than in previous decades. We can also visualize this with confidence intervals.\n\n\nCode\n# Create confidence interval\nseg_model_se &lt;- predict(object = seg_model,\n                          newdata = pred_grid,\n                          type = \"link\",\n                          se.fit = TRUE)\n\n# Go from link space to response space\nlinkinv &lt;- family(seg_model)$linkinv\n\nseg_model_pred &lt;- pred_grid %&gt;% \n  mutate(\n    # get logit(p)\n    logit_p = seg_model_se$fit,\n    # 95% CI in link space\n    logit_p_se = seg_model_se$se.fit,\n    logit_p_lwr = qnorm(0.025, mean = logit_p, sd = logit_p_se),\n    logit_p_upr = qnorm(0.975, mean = logit_p, sd = logit_p_se),\n    # undo the link function using linkinv\n    p = linkinv(logit_p),\n    p_lwr = linkinv(logit_p_lwr),\n    p_upr = linkinv(logit_p_upr)\n  )\n\n# filter predictions to a few years\nseg_model_pred_filtered &lt;- seg_model_pred %&gt;%\n  filter(year %in% c(1900, 1940, 1980, 2020)) %&gt;%\n  mutate(year = factor(year))\n\n\n\n\nCode\n# plot \nggplot(seg_model_pred_filtered, aes(x = doy, y = p, fill = year))+\n  geom_ribbon(aes(ymin = p_lwr, ymax = p_upr), alpha = 0.2) +\n  scale_fill_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nBased upon this figure, the CI for the year 2020 is visually distinct from the previous decades that were plotted.\nI also found Davies’ test for a change in slope, which is specifically for hypothesis testing for breakpoints. It evaluates whether the difference in slopes is significantly different from 0, or whether we actually need a breakpoint (Muggeo 2025).\n\n\nCode\ndavies &lt;- davies.test(bin_model, seg.Z = ~ year, k=10)\n\n# Make coefficient table \ntidy(davies) %&gt;%\n  kable(digits = 3, caption = \"Davies Test Results\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nDavies Test Results\n\n\nstatistic\np.value\nparameter\nmethod\nalternative\n\n\n\n\n1962.111\n0.346\n8\nDavies' test for a change in the slope\ntwo.sided\n\n\n\n\n\n\n\n\nIf we look back at our hypotheses:\n\nNull hypothesis (H0): One slope describes the effect of year on leaf coloration (slopes are the same before and after breakpoint)\n\nH0: \\(\\beta_3 = 0\\)\n\nAlternative hypothesis (Ha): Multiple slopes describe the effect of year on leaf coloration (slopes are different before and after breakpoint)\n\nHa: \\(\\beta_3 \\neq 0\\)\nBecause the resulting p-value was 0.35 and far above 0.05, we cannot reject H0 that one slope describes the effect of year on leaf coloration, and therefore don’t see that there is a significant change in the shift in the doy of leave coloration over time. A lot of our results were not intuitive, as we would assume that leaf coloration would be seen earlier in the year due to climate change and warmer temperatures being experienced earlier in the year. The difference in our results might be due to different statistical methodology or an uneven sample, where there were far less specimens with colored leaves to include as data in our model. In further analysis, I would like to dive deeper into what variables might be confounding these results such as seasonality or location, or attempt to use a GAM to look at non-linear relationships between predictor and response variables. Lastly, the data set contained a binary variable for leaf presence, which could affect our results as Maple leaves fall after changing color and would create a narrow window to detect color."
  },
  {
    "objectID": "posts/2025-12-01-eds222/index.html#question-and-data",
    "href": "posts/2025-12-01-eds222/index.html#question-and-data",
    "title": "EDS 222: Herbarium Specimen Phenology",
    "section": "",
    "text": "Many studies have found climate-related delays in the timing of leaf coloration, but do not have a lot of data from before the late 20th century (Garretson and Forkner 2021b).\nA data set collected by Garretson and Forkner in 2021 from the Southeast Regional Network of Expertise and Collections (SERNEC n.d.) contains evaluations of 2,972 digitized herbaria specimens of red and sugar maples collected between 1826 and 2016. They paired these specimens with climate and locality information to investigate long-term trends in autumn phenology over the past century (Garretson and Forkner 2021a).\nUsing this data, I want to analyze the effects of day of year (doy), year, and mean fall temperature on the presence of colored leaves as well as determine whether the day of the year when there becomes a higher probability of leaf color is shifting earlier over time.\n\n\n\n\nDAG\n\n\n\nI think that year, day of the year, and mean fall temperature all have an effect on whether a leaf is colored. Day of year is a seasonal relationship, where leaf coloration is expected the least in the summer (~180-250 doy) and more after that period in the fall (~250-300 doy). Cooler fall temperatures could cause a quicker onset of leaf coloration and senescence, while warmer mean temperatures could delay it. Year also could have an effect on how day of the year affects leaf coloration, as over time the day of year that is associated with higher probabilities of leaf coloration could shift. Year could also affect mean fall temperatures, as some years are generally warmer or cooler than others.\n\n\n\n\nCode\nlibrary(here)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(segmented)\nlibrary(kableExtra)\nlibrary(broom)\nlibrary(gtsummary)\nlibrary(modelsummary)\n\n# Read in data\nautumn_data &lt;- read_csv(here::here(\"posts\", \"2025-12-01-eds222\", \"data\", \"autumn_data.csv\")) %&gt;% \n  clean_names() \n\n\n\n\n\n\n\nCode\nggplot(autumn_data, aes(x = longitude, y = latitude)) +\n  geom_point(alpha = 0.5, color = \"darkgreen\") +\n  labs(x = \"Longitude\", y = \"Latitude\", \n       title = \"Herbarium Specimen Locations\") +\n  theme_minimal()\n\n\n\n\n\nFigure 1: Initial exploration of the spatial distribution of Herbarium specimens.\n\n\n\n\nThe specimens are located relatively uniformly throughout the Northeast.\n\n\nCode\n# Create scatter plot\nggplot(autumn_data, aes(x = doy, y = colored_leaves, color = species)) +\n  geom_jitter(alpha = 0.5, width = 0, height = 0.1) +\n  scale_color_manual(values = c(\"#6F8FAF\", \"#8A9A5B\")) +\n  labs(x = \"Day of year\",\n       y = \"Colored leaves\") +\n  theme_minimal() \n\n\n\n\n\nFigure 2: Initial exploration of the effects of day of the year on the presence of colored leaves (0/1).\n\n\n\n\nThe binary colored_leaves variable appears to have many more specimens with non-colored leaves, which are spread throughout the entire year but show a cluster between about doy 80 and 300. There are fewer specimens with colored leaves, with a more concentrated spread between doy 100 and 320. This data distribution suggests that a logistic regression model could be a good fit.\n\n\nCode\n# Filter data to a few years to visualize this over time\nautumn_data_decades &lt;- autumn_data %&gt;% \n  filter(year %in% c(1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020))\n\n# Create scatter plot\nggplot(autumn_data_decades, aes(x = doy, y = colored_leaves, color = year)) +\n  geom_jitter(alpha = 0.6, width = 0, height = 0.1) +\n  scale_color_gradientn(colors = c(\"#FFBF00\", \"orange\",\"#CC5500\", \"#C41E3A\", \"#660033\"), guide = \"none\") +\n  labs(x = \"Day of year\",\n       y = \"Colored leaves\") +\n  facet_wrap(~year) +\n  theme_minimal() \n\n\n\n\n\nFigure 3: Initial exploration of the effects of day of the year on the presence of colored leaves (0/1).\n\n\n\n\nThis plot shows that there are relatively few colored leaf data points in each year of observation, which might create a challenge when trying to draw conclusions.\n\n\n\nAfter exploring the data, I want to fit a binomial model with day of year, year, and mean fall temperature as predictors and colored leaves as a binary response.\n\n# Binomial model\nbin_model &lt;- glm(colored_leaves ~ doy + year + mean_fall,\n                 data = autumn_data,\n                 family = binomial(link = \"logit\"))\n\n\n\nCode\n# Create coefficient table\ntidy(bin_model) %&gt;%\n  kable(digits = 3, caption = \"Coefficient Estimates for Binomial Model\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Estimates for Binomial Model\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n1.348\n3.469\n0.389\n0.697\n\n\ndoy\n0.013\n0.001\n14.664\n0.000\n\n\nyear\n-0.003\n0.002\n-1.745\n0.081\n\n\nmean_fall\n0.029\n0.028\n1.054\n0.292\n\n\n\n\n\nOnly the day of year variable is significant, with a p-value below 0.05. The positive coefficients for doy and mean_fall could indicate that the probability of colored leaves increases later in the year and with warmer fall temperatures. The slightly negative sign of year indicates that the probability of colored leaves decreases in some way each year.\n\n\n\nNext, I want to look at the model fit over a selection of years to better visualize whether doy where probability of colored leaves shifts from 0 to 1 becomes earlier over time. Setting mean_fall to the average allows us to focus on the relationship between day of year and year on leaf coloration.\n\n\nCode\n# Pick four years to model\nyears &lt;- c(1900, 1940, 1980, 2020)\n\n# Make data frame of predictors using means for fixed variables\npred_grid &lt;- expand_grid(\n  doy = 1:365,\n  year = years,\n) %&gt;% \n  mutate(\n    mean_fall = mean(autumn_data$mean_fall, na.rm = TRUE)\n  )\n\n# Generate predictions using model- just best estimate\nbin_model_pred &lt;- pred_grid %&gt;% \n  mutate(p = predict(object = bin_model,\n                     newdata = pred_grid,\n                     type = \"response\"))\n\n\n\n\nCode\n# Plot predictions for three years \nggplot(bin_model_pred, aes(x = doy, y = p, color = factor(year))) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  scale_color_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  labs(color = \"Year\", y = \"p\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nWe can also transition between link and response space to visualize this plot with confidence intervals.\n\n\nCode\n# Create confidence interval\nbin_model_se &lt;- predict(object = bin_model,\n                          newdata = pred_grid,\n                          type = \"link\", # stay in link space!\n                          se.fit = TRUE) # get the se of the fit\n\n# Go from link space to response space\nlinkinv &lt;- family(bin_model)$linkinv\n\nbin_model_pred_l &lt;- pred_grid %&gt;% \n  mutate(\n    # get logit(p)\n    logit_p = bin_model_se$fit,\n    # 95% CI in link space- keeps in realistic range of values!! can do math here\n    logit_p_se = bin_model_se$se.fit,\n    logit_p_lwr = qnorm(0.025, mean = logit_p, sd = logit_p_se),\n    logit_p_upr = qnorm(0.975, mean = logit_p, sd = logit_p_se),\n    # undo the link function using linkinv- can interpret here\n    p = linkinv(logit_p),\n    p_lwr = linkinv(logit_p_lwr),\n    p_upr = linkinv(logit_p_upr)\n  )\n\n# filter predictions to a few years\nbin_model_pred_l_filtered &lt;- bin_model_pred_l %&gt;%\n  filter(year %in% c(1900, 1940, 1980, 2020)) %&gt;%\n  mutate(year = factor(year))\n\n# plot \nggplot(bin_model_pred_l_filtered, aes(x = doy, y = p, fill = year))+\n  geom_ribbon(aes(ymin = p_lwr, ymax = p_upr), alpha = 0.2) +\n  scale_fill_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nBased on this figure, the day of year where leaf coloration probability is 0.5 is shifting to the right from 1900 to 2020, or becoming later in the year over time.\nTo see if my results will change due to seasonality and when colored leaves are most probable, I want to make mid-summer associated with 0 as this is when there is most likely to be 0 colored leaves, and shift the other days of the year accordingly. I also want to group the data by decade to create more data points for plotting, to correct for the issues seen in Figure 3 of my data exploration.\n\n# Mutate data \nautumn_data_decadegroups &lt;- autumn_data %&gt;% \n  mutate(doy_summer = (doy - 180) %% 365,\n         decade = floor(year/10) * 10) \n\n\n# Fit model based on mutated data\nbin_model_summer &lt;- glm(colored_leaves ~ doy_summer + decade + mean_fall,\n                 data = autumn_data_decadegroups,\n                 family = binomial(link = \"logit\"))\n\n\n\nCode\n# Create coefficient table\ntidy(bin_model_summer) %&gt;%\n  kable(digits = 3, caption = \"Coefficient Estimates for Binomial Decade Model\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Estimates for Binomial Decade Model\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n2.704\n3.266\n0.828\n0.408\n\n\ndoy_summer\n-0.003\n0.000\n-6.915\n0.000\n\n\ndecade\n-0.002\n0.002\n-1.280\n0.201\n\n\nmean_fall\n0.021\n0.026\n0.811\n0.417\n\n\n\n\n\nOnly day of year continued to be statistically significant, but in contrast to the previous model is negative. Let’s see what this looks like plotted!\n\n\nCode\n# Pick four decades to model\ndecades &lt;- c(1900, 1940, 1980, 2010)\n\n# Make data frame of predictors using means for fixed variables\npred_grid2 &lt;- expand_grid(\n  doy_summer = 1:365,\n  decade = decades,\n) %&gt;% \n  mutate(\n    mean_fall = mean(autumn_data_decadegroups$mean_fall, na.rm = TRUE)\n  )\n\n# Generate predictions using model- just best estimate\nbin_model_pred2 &lt;- pred_grid2 %&gt;% \n  mutate(p = predict(object = bin_model_summer,\n                     newdata = pred_grid2,\n                     type = \"response\"))\n\n\n\n\nCode\n# Plot predictions for four decades\nggplot(bin_model_pred2, aes(x = doy_summer, y = p, color = factor(decade))) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  labs(color = \"Decade\", y = \"p\") +\n  scale_color_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThis plot shows a negative trend in leave coloration probability over time with a starting point of mid summer.\n\n\n\nNext, I want to try to use a segmented model to look at the rate of change between these curves and determine whether the doy at which the probability of having colored leaves increases shifts back at a faster rate after a certain year break point.\n\\[\n\\text{BinaryOutcome} \\sim \\text{Binomial}(1, p)\n\\]\n\\[\n\\text{logit}(p) =\n\\beta_0 + \\beta_1 \\cdot \\text{doy} + \\beta_2 \\cdot \\text{year} + \\beta_3 \\cdot \\text{year} \\cdot \\text{after} + \\beta_4 \\cdot \\text{meanfall}\n\\]\n\\[\n\\text{after}=\n\\begin{cases}\n0 & \\text{if year} \\le \\psi \\\\\n1 & \\text{if year} &gt; \\psi\n\\end{cases}\n\\]\nA segmented model allows for a change in the relationship between response and explanatory variables at a breakpoint, where beta 3 gets added to the slope of beta 2 if the year is beyond the breakpoint (Kaizer n.d.). Based on this idea, I set up my hypotheses:\n\n\n\nNull hypothesis (H0): One slope describes the effect of year on leaf coloration (slopes are the same before and after breakpoint)\n\nH0: \\(\\beta_3 = 0\\)\n\nAlternative hypothesis (Ha): Multiple slopes describe the effect of year on leaf coloration (slopes are different before and after breakpoint)\n\nHa: \\(\\beta_3 \\neq 0\\)\nBefore applying this model to my actual data, we can use a simplified model to simulate data from and better understand how a segmented model works:\n\\[\n\\text{BinaryOutcome} \\sim \\text{Binomial}(1, p)\n\\]\n\\[\n\\text{logit}(p) =\n\\beta_0 + \\beta_1 \\cdot \\text{x} + \\beta_2 \\cdot \\text{x} \\cdot \\text{afterbreakpoint}\n\\]\nWhere afterbreakpoint is a binary variable where 0 corresponds to before the determined breakpoint and 1 is after. This allows us to have the different slopes depending upon where we are along the x-axis. This difference in slopes is beta 2.\nWe will use these steps:\n\nChoose a set of parameters and predictor variable(s) for the simulation\n\n\n\nCode\nset.seed(123)\n\n# 1. Choose a set of parameters \nbeta0 &lt;- 0\nbeta1 &lt;- 0.4\nbeta2 &lt;- 0.5\n\n# Create x values\nx_before &lt;- seq(0, 20, length.out = 1000)\n\n# Want breakpoint to be the middle @ x = 10\n# Subtract 10 from every x value\nx &lt;- x_before - 10\n\n# Create breakpoint indicator- now @ x = 0 \n# make this 0 if x is negative and 1 if x is positive\nafterbreakpoint &lt;- case_when(\n  x &lt; 0 ~ 0,\n  x &gt;= 0 ~ 1\n)\n\n\n\nUse a random variable to generate a response, based on the parameters and predictor(s)\n\n\n\nCode\n# Write out formula based on model notation\nlogit_p &lt;- beta0 + beta1*x + beta2*(x*afterbreakpoint)\n\np &lt;- exp(logit_p) / (1 + exp(logit_p))\n\n# 2. Use a random variable to generate Binary outcomes\ny &lt;- rbinom(n = length(p), size = 1, prob = p)\n\n# Create full simulated data\nsim_dat &lt;- tibble(x, afterbreakpoint, y) \n\n\n\nFit a model to the simulated data\n\n\n\nCode\n# 3. Fit model to simulated data\nsim_mod &lt;- glm(y ~ x + x:afterbreakpoint,\n                 data = sim_dat,\n                 family = binomial(link = \"logit\"))\n\n\n\nCheck if the model’s parameter estimates match selected parameters\n\n\n\nCode\n# 4. Check if model's parameters match \nmod_summ &lt;- summary(sim_mod)\nbeta_0_hat &lt;- coef(sim_mod)[1]\nbeta_1_hat &lt;- coef(sim_mod)[2]\nbeta_2_hat &lt;- coef(sim_mod)[3]\n\n# Create kable table with values for comparison\ncomparison_table &lt;- rbind(\n  Selected = round(c(beta0, beta1, beta2), 2),\n  Model = round(c(beta_0_hat, beta_1_hat, beta_2_hat), 2))\n\ncolnames(comparison_table) &lt;- c(\"Beta 0\", \"Beta 1\", \"Beta 2\")\n\nkable(comparison_table, caption = \"Coefficient Comparisons\", align = \"c\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Comparisons\n\n\n\nBeta 0\nBeta 1\nBeta 2\n\n\n\n\nSelected\n0.00\n0.40\n0.5\n\n\nModel\n-0.02\n0.42\n0.4\n\n\n\n\n\nThe Intercept (beta 0) was very close to the selected value of 0, and the x (beta 1) was very close to the selected value of 0.4. The x associated with being after the breakpoint (beta 2) was slightly lower than the selected value of 0.5.\n\n\n\n\nNow, I want to apply a segmented model to my original binomial model at an estimated break point in 1980.\n\n# Segmented model using initial binomial model\nseg_model &lt;- segmented(bin_model, seg.Z = ~year, psi = list(year = 1980))\n\n\n\nCode\n# Create coefficient table\ntidy(seg_model) %&gt;%\n  kable(digits = 3, caption = \"Coefficient Estimates for Segmented Model\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nCoefficient Estimates for Segmented Model\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n-9.523\n7.893\n-1.207\n0.228\n\n\ndoy\n0.013\n0.001\n14.603\n0.000\n\n\nyear\n0.003\n0.004\n0.616\n0.538\n\n\nmean_fall\n0.027\n0.028\n0.978\n0.328\n\n\nU1.year\n-0.015\n0.007\n-2.040\n0.041\n\n\npsi1.year\n0.000\n14.130\n0.000\n1.000\n\n\n\n\n\n\n\nCode\nseg_ci &lt;- confint(seg_model)\n\n# Convert to data frame for kable\nci_table &lt;- as.data.frame(seg_ci)\nci_table$Term &lt;- rownames(ci_table)\ncolnames(ci_table) &lt;- c(\"Est.\", \"Lower\", \"Upper\")  \n\n# Reorder columns \nci_table &lt;- ci_table[, c(\"Est.\", \"Lower\", \"Upper\")]\n\n# Round and make table\nci_table %&gt;%\n  round(2) %&gt;%\n  kable(caption = \"Segmented Model 95% Confidence Intervals\", align = \"c\") %&gt;%\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\n\n\n\nSegmented Model 95% Confidence Intervals\n\n\n\nEst.\nLower\nUpper\n\n\n\n\npsi1.year\n1968\n1940.29\n1995.71\n\n\n\n\n\nThe estimated break point (where the slope of year changes) was in 1968, with a standard error of about 14 years ranging between 1940 and 1996 (the 95% CI). This is quite a large range! The coefficients for doy, year, and mean_fall were all slightly positive, but only doy was significant, indicating that the the probability of colored leaves increases later in the year. The estimate for U1.year, or the change in slope after the breakpoint, was -0.0145. Subtracting this value from the original slope for year (beta 2, 0.0025), the estimated slope after the breakpoint was -0.012. In context, the slope for year changed from slightly positive to slightly negative after the breakpoint in 1968.\n\n\nCode\n# Make data frame of predictors using means for fixed variables\npred_grid &lt;- expand_grid(\n  doy = 1:365,\n  year = years\n) %&gt;% \n  mutate(\n    mean_fall = mean(autumn_data$mean_fall, na.rm = TRUE),\n    annual_precip = mean(autumn_data$annual_precip, na.rm = TRUE)\n  )\n\n# Generate predictions using model- just best estimate\nseg_model_pred &lt;- pred_grid %&gt;% \n  mutate(p = predict(object = seg_model,\n                     newdata = pred_grid,\n                     type = \"response\"))\n\n\n\n\nCode\n# Plot predictions for three years \nggplot(seg_model_pred, aes(x = doy, y = p, color = factor(year))) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  scale_color_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  labs(color = \"Year\", y = \"p\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n2020 has a clearly lower slope than the other years, indicating the probability of colored leaves being lower further into the year than in previous decades. We can also visualize this with confidence intervals.\n\n\nCode\n# Create confidence interval\nseg_model_se &lt;- predict(object = seg_model,\n                          newdata = pred_grid,\n                          type = \"link\",\n                          se.fit = TRUE)\n\n# Go from link space to response space\nlinkinv &lt;- family(seg_model)$linkinv\n\nseg_model_pred &lt;- pred_grid %&gt;% \n  mutate(\n    # get logit(p)\n    logit_p = seg_model_se$fit,\n    # 95% CI in link space\n    logit_p_se = seg_model_se$se.fit,\n    logit_p_lwr = qnorm(0.025, mean = logit_p, sd = logit_p_se),\n    logit_p_upr = qnorm(0.975, mean = logit_p, sd = logit_p_se),\n    # undo the link function using linkinv\n    p = linkinv(logit_p),\n    p_lwr = linkinv(logit_p_lwr),\n    p_upr = linkinv(logit_p_upr)\n  )\n\n# filter predictions to a few years\nseg_model_pred_filtered &lt;- seg_model_pred %&gt;%\n  filter(year %in% c(1900, 1940, 1980, 2020)) %&gt;%\n  mutate(year = factor(year))\n\n\n\n\nCode\n# plot \nggplot(seg_model_pred_filtered, aes(x = doy, y = p, fill = year))+\n  geom_ribbon(aes(ymin = p_lwr, ymax = p_upr), alpha = 0.2) +\n  scale_fill_manual(values = c(\"1900\" = \"#FFBF00\", \"1940\" = \"#CC5500\", \"1980\" = \"#C41E3A\", \n                                \"2020\" = \"#660033\")) +\n  geom_line() +\n  coord_cartesian(ylim = c(0,1)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nBased upon this figure, the CI for the year 2020 is visually distinct from the previous decades that were plotted.\nI also found Davies’ test for a change in slope, which is specifically for hypothesis testing for breakpoints. It evaluates whether the difference in slopes is significantly different from 0, or whether we actually need a breakpoint (Muggeo 2025).\n\n\nCode\ndavies &lt;- davies.test(bin_model, seg.Z = ~ year, k=10)\n\n# Make coefficient table \ntidy(davies) %&gt;%\n  kable(digits = 3, caption = \"Davies Test Results\") %&gt;% \n  kable_styling(bootstrap_options = \"striped\")\n\n\n\nDavies Test Results\n\n\nstatistic\np.value\nparameter\nmethod\nalternative\n\n\n\n\n1962.111\n0.346\n8\nDavies' test for a change in the slope\ntwo.sided\n\n\n\n\n\n\n\n\nIf we look back at our hypotheses:\n\nNull hypothesis (H0): One slope describes the effect of year on leaf coloration (slopes are the same before and after breakpoint)\n\nH0: \\(\\beta_3 = 0\\)\n\nAlternative hypothesis (Ha): Multiple slopes describe the effect of year on leaf coloration (slopes are different before and after breakpoint)\n\nHa: \\(\\beta_3 \\neq 0\\)\nBecause the resulting p-value was 0.35 and far above 0.05, we cannot reject H0 that one slope describes the effect of year on leaf coloration, and therefore don’t see that there is a significant change in the shift in the doy of leave coloration over time. A lot of our results were not intuitive, as we would assume that leaf coloration would be seen earlier in the year due to climate change and warmer temperatures being experienced earlier in the year. The difference in our results might be due to different statistical methodology or an uneven sample, where there were far less specimens with colored leaves to include as data in our model. In further analysis, I would like to dive deeper into what variables might be confounding these results such as seasonality or location, or attempt to use a GAM to look at non-linear relationships between predictor and response variables. Lastly, the data set contained a binary variable for leaf presence, which could affect our results as Maple leaves fall after changing color and would create a narrow window to detect color."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Ava Robillard",
    "section": "",
    "text": "Hi! I’m Ava Robillard, and I am an early career data scientist. My background is in plant science and I am passionate about expanding this subject area to broader issues in sustainability with creative as well as organized data science approaches. When I’m not busy coding, you can usually find me out hiking, running, or reading."
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Blog",
    "section": "",
    "text": "EDS 220: Eaton and Palisades Fires\n\n\n\nMEDS\n\nPython\n\n\n\nAn analysis covering false color imagery and social dimensions\n\n\n\nAva Robillard\n\n\nDec 1, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nEDS 222: Herbarium Specimen Phenology\n\n\n\nMEDS\n\nR\n\n\n\nA statistical analysis of shifts in leaf color timing\n\n\n\nAva Robillard\n\n\nDec 1, 2025\n\n\n\n\n\n\n\n\n\n\n\nEDS 223: Houston Power Grids\n\n\n\nMEDS\n\nR\n\n\n\nA geospatial analyis of the effects of winter storms on power outages\n\n\n\nAva Robillard\n\n\nDec 1, 2025\n\n\n\n\n\n\nNo matching items"
  }
]